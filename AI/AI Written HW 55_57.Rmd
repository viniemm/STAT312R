---
title: "AI Written Q55 to Q57"
author: "Vinayak Mathur, Devin Lin, Ramon Wang"
date: "4/15/2022"
output:
pdf_document: default
html_document:
df_print: paged
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

### Question 55:

The data used  for Figure  20.1 in the book can be viewed as being generated by hypothesis h5. For hypotheses h3 and h4, generate one dataset each of size $200$ and plot graphs for $P(h_i|d_1,...d_N)$, $i=1,..,5,$ as $N$ varies from $1$ to $200$.

For our candy example, we will assume for the time being that the prior distribution
over $h_1,...,h_5$ is given by $⟨0.1,0.2,0.4,0.2,0.1⟩$, as advertised by the manufacturer.

Lime candy is denoted by 1, cherry is denoted by 0. This can be represented as a binomial distribution.

#### $h3:$ $50$% cherry + $50$% lime $(\mu = 0.5)$

```{r}

main_func <- function(prob) {

  theta <- c(0.0, 0.25, 0.5, 0.75, 1)

  n <- 200

  candyData <- rbinom(n, 1, prob)

  phd1 <- c(0.1)
  phd2 <- c(0.2)
  phd3 <- c(0.4)
  phd4 <- c(0.2)
  phd5 <- c(0.1)


  for (d in candyData) {
    if (d == 1) {
      phd1 <- append(phd1, theta[1])
      phd2 <- append(phd2, theta[2])
      phd3 <- append(phd3, theta[3])
      phd4 <- append(phd4, theta[4])
      phd5 <- append(phd5, theta[5])
    }
    else {
      phd1 <- append(phd1, 1 - theta[1])
      phd2 <- append(phd2, 1 - theta[2])
      phd3 <- append(phd3, 1 - theta[3])
      phd4 <- append(phd4, 1 - theta[4])
      phd5 <- append(phd5, 1 - theta[5])
    }
  }

  for (x in 2:(length(candyData) + 1)) {
    phd1[x] <- phd1[x - 1] * phd1[x]
    phd2[x] <- phd2[x - 1] * phd2[x]
    phd3[x] <- phd3[x - 1] * phd3[x]
    phd4[x] <- phd4[x - 1] * phd4[x]
    phd5[x] <- phd5[x - 1] * phd5[x]

    totx <- phd1[x] +
      phd2[x] +
      phd3[x] +
      phd4[x] +
      phd5[x]

    phd1[x] <- phd1[x] / totx
    phd2[x] <- phd2[x] / totx
    phd3[x] <- phd3[x] / totx
    phd4[x] <- phd4[x] / totx
    phd5[x] <- phd5[x] / totx

  }

  plot(phd1, type = "l", col = "red", xlab = "Number of observations in d", ylab = "Posterior probability of hypothesis", xlim = c(1, (n + 1)), ylim = c(0, 1), main = "Posterior probabilities P(hi |d1,...,dN)")
  # axis(1, at= 1:(n+1), rep(0:n))
  lines(phd2, type = "l", col = "green")
  lines(phd3, type = "l", col = "blue")
  lines(phd4, type = "l", col = "darkgrey")
  lines(phd5, type = "l", col = "purple")
}

main_func(0.5)

```

#### $h4:$ $25$% cherry + $75$% lime $(\mu = 0.75)$

```{r}
main_func(0.75)
```